<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner-lite.html">

<link rel="import" href="ytp-video-card.html">

<link rel="import" href="redux-store.html">

<dom-module id="ytp-trending">
  <template>
    <style>
      :host {
        display: block;
        padding: 10px;
      }
      ytp-video-card {
        margin: 5px;
      }
      paper-spinner-lite:not([active]) {
        display: none;
      }
    </style>

    <h2>Now trending</h2>
    <paper-spinner-lite active="[[loading]]"></paper-spinner-lite>
    <template is="dom-repeat" items="[[trendingVideos]]" as="video">
      <ytp-video-card video="[[video]]"></ytp-video-card>
    </template>

  </template>

  <script>
    class YtpTrending extends YtpStore(Polymer.Element) {
      static get is() { return 'ytp-trending'; }
      static get properties() {
        return {
          trendingIds: {
            statePath: 'trendingVideos.items'
          },
          videos: {
            statePath: 'videos'
          },
          trendingVideos: {
            computed: 'computeVideos(videos, trendingIds)'
          },
          loading: {
            statePath: 'trendingVideos.loading'
          }
        }
      }

      computeVideos(videos, trendingIds) {
        return videos && trendingIds && trendingIds.map(id => videos[id]);
      }

    }

    window.customElements.define(YtpTrending.is, YtpTrending);
  </script>
</dom-module>
